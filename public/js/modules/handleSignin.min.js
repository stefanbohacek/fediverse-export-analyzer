import getUrlParams from"/js/modules/getUrlParams.min.js";import Cookie from"/js/cookies/main.min.js";const cookieManager=new Cookie,signinForm=document.getElementById("signin-form"),instance=document.getElementById("instance"),signinButton=document.getElementById("signin-btn"),toggleFormElements=e=>{"true"===e.dataset.enabled?(instance.disabled=!0,signinButton.disabled=!0,signinButton.innerHTML="Loading...",e.dataset.enabled="false"):(instance.disabled=!1,signinButton.disabled=!1,signinButton.innerHTML="Sign in",e.dataset.enabled="true")},handleSignin=()=>{if(signinForm&&(signinForm.addEventListener("submit",async e=>{e.preventDefault(),toggleFormElements(signinForm);e=await(await fetch("https://fediverse-info.stefanbohacek.dev/node-info?domain="+instance.value)).json();e&&e.software?window.location.href=`https://auth.stefanbohacek.dev/?method=fediverse&instance=${instance.value}&scope=read:accounts&app=localhost-3000&platform=`+e.software:(alert("This doesn't look like a fediverse instance."),toggleFormElements(signinForm))}),"/"===window.location.pathname)){var e=getUrlParams(),n=cookieManager.get("fpusr"),t=document.getElementById("popover-start");if(t&&t.classList.add("show"),!e.logout&&n){const{instance,platform:i,token:o}=JSON.parse(n);instance&&i&&o&&(window.location.href=`/?instance=${instance}&platform=${i}&token=`+o)}}};export default handleSignin;
//# sourceMappingURL=handleSignin.min.js.map
